# 性能优化(Optimizing Performance)
## 使用生产版本
得到压缩

## 虚拟化长列表
- react-window
- react-virtualized

## shouldComponentUpdate的作用
决定DOM节点是否需要重新渲染  

```
class CounterButton extends React.Component {
  constructor(props) {
    super(props);
    this.state = {count: 1};
  }

  shouldComponentUpdate(nextProps, nextState) {
    if (this.props.color !== nextProps.color) {
      return true;
    }
    if (this.state.count !== nextState.count) {
      return true;
    }
    return false;
  }

  render() {
    return (
      <button
        color={this.props.color}
        onClick={() => this.setState(state => ({count: state.count + 1}))}>
        Count: {this.state.count}
      </button>
    );
  }
}
```

使用**React.PureComponent**进行props和state的**浅比较**，以此来决定组件是否需要更新  

```
class CounterButton extends React.PureComponent {
  constructor(props) {
    super(props);
    this.state = {count: 1};
  }

  render() {
    return (
      <button
        color={this.props.color}
        onClick={() => this.setState(state => ({count: state.count + 1}))}>
        Count: {this.state.count}
      </button>
    );
  }
}
```

## 不可变数据
```
function updateColorMap(colormap) {
    colormap.right = 'blue';
}
```

为了不改变原本的对象，使用Object.assign  

```
function updateColorMap(colormap) {
    return Object.assign({},colormap,{right:'blue'});
}
```

```
function updateColoeMap(colormap) {
    return {...colormap,right:'blue'}
}
```

